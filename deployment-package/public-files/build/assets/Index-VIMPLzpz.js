import{r as z,u as E,j as e,H as $}from"./app-De9YtYVO.js";import{D as Q}from"./DashboardLayout-DB0kk3mn.js";import{D as G}from"./data-table-D4pKVaNe.js";import{columns as J}from"./columns-C77nTDdh.js";import{B as o,a as f}from"./index-sqIKGjOx.js";import{D as K,a as U,b as W,c as X,d as Y,e as Z,f as ee}from"./dialog-B_EPHwqc.js";import{I as j}from"./input-YJ4y34zb.js";import{L as n}from"./label-BNYjQoyA.js";import{T as se}from"./textarea-BrFMof27.js";import{S as g,a as N,b,c as _,d as C}from"./select-B2rqhBdx.js";import{P as w,a as D,b as T,C as S}from"./calendar-DDO4Otf0.js";import{T as ae,a as re,b as O,c as m,d as te,e as h}from"./table-3xAxy9mO.js";import{u as ie}from"./useTranslation-CmIvGiqX.js";import{P}from"./plus-DIUrj948.js";import{C as I}from"./calendar-DaZVa6bq.js";import{T as le}from"./trash-2-Dreerc3R.js";import{L as de}from"./loader-circle-DjIWaf7f.js";import{f as F}from"./format-BS8Ay9AX.js";import"./toaster-CljvMPLZ.js";import"./Combination-Dy-FKPUP.js";import"./dropdown-menu-BBgrL1DT.js";import"./index-DEhQiHRI.js";import"./x-D7kv7_oa.js";import"./file-text-D4ZH2B6r.js";import"./building-2-B8zwlaZI.js";import"./users-Cw2EaZtR.js";import"./package-DX_4eLNa.js";import"./LanguageSwitcher-JaZwuRsp.js";import"./globe-BnAvlmAt.js";import"./ThemeToggle-IPjgC8LT.js";import"./circle-alert-nT1vmDMj.js";import"./checkbox-DSt0QHsS.js";import"./index-CENxNQLL.js";import"./badge-C9h6T3rK.js";import"./arrow-up-down-1q5LzOz0.js";import"./ellipsis-yQlqSxW1.js";import"./chevron-left-BEvpDX_2.js";function Qe({deliveryOrders:k,customers:q,products:u}){const{t:a}=ie(),[H,p]=z.useState(!1),{data:r,setData:d,post:L,processing:v,errors:c,reset:M}=E({customer_id:"",date:new Date,delivered_at:void 0,delivery_address:"",notes:"",items:[{product_id:"",description:"",quantity:1}]}),A=()=>{d("items",[...r.items,{product_id:"",description:"",quantity:1}])},B=s=>{if(r.items.length<=1)return;const i=r.items.filter((t,l)=>l!==s);d("items",i)},x=(s,i,t)=>{const l=[...r.items];if(i==="product_id"){const y=u.find(V=>V.id.toString()===t);y?l[s]={...l[s],product_id:t,description:y.name}:l[s]={...l[s],[i]:t}}else l[s]={...l[s],[i]:t};d("items",l)},R=s=>{s.preventDefault(),L(route("sales.delivery-orders.store"),{onSuccess:()=>{p(!1),M()}})};return e.jsxs(Q,{header:a("deliveryOrders.title"),children:[e.jsx($,{title:a("deliveryOrders.title")}),e.jsxs("div",{className:"flex-1 space-y-4 p-8 pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between space-y-2",children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:a("deliveryOrders.title")}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(K,{open:H,onOpenChange:p,children:[e.jsx(U,{asChild:!0,children:e.jsxs(o,{children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),a("deliveryOrders.create")]})}),e.jsxs(W,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(X,{children:[e.jsx(Y,{children:a("deliveryOrders.create")}),e.jsx(Z,{children:a("deliveryOrders.new")})]}),e.jsxs("form",{onSubmit:R,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"customer_id",children:a("sales.customer")}),e.jsxs(g,{value:r.customer_id,onValueChange:s=>d("customer_id",s),children:[e.jsx(N,{children:e.jsx(b,{placeholder:a("user.selectCompany")})}),e.jsx(_,{children:q?.map(s=>e.jsxs(C,{value:s.id.toString(),children:[s.name," ",s.company_name?`(${s.company_name})`:""]},s.id))})]}),c.customer_id&&e.jsx("p",{className:"text-sm text-red-500",children:c.customer_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:a("sales.date")}),e.jsxs(w,{children:[e.jsx(D,{asChild:!0,children:e.jsxs(o,{variant:"outline",className:f("w-full pl-3 text-left font-normal",!r.date&&"text-muted-foreground"),children:[r.date?F(r.date,"dd/MM/yyyy"):e.jsx("span",{children:"Pick a date"}),e.jsx(I,{className:"ml-auto h-4 w-4 opacity-50"})]})}),e.jsx(T,{className:"w-auto p-0",align:"start",children:e.jsx(S,{mode:"single",selected:r.date,onSelect:s=>s&&d("date",s),initialFocus:!0})})]}),c.date&&e.jsx("p",{className:"text-sm text-red-500",children:c.date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{children:[a("deliveryOrders.deliveryDate")," ",a("common.optional")]}),e.jsxs(w,{children:[e.jsx(D,{asChild:!0,children:e.jsxs(o,{variant:"outline",className:f("w-full pl-3 text-left font-normal",!r.delivered_at&&"text-muted-foreground"),children:[r.delivered_at?F(r.delivered_at,"dd/MM/yyyy"):e.jsx("span",{children:"Pick a date"}),e.jsx(I,{className:"ml-auto h-4 w-4 opacity-50"})]})}),e.jsx(T,{className:"w-auto p-0",align:"start",children:e.jsx(S,{mode:"single",selected:r.delivered_at,onSelect:s=>d("delivered_at",s),initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"delivery_address",children:a("deliveryOrders.deliveryAddress")}),e.jsx(j,{id:"delivery_address",value:r.delivery_address,onChange:s=>d("delivery_address",s.target.value),placeholder:a("deliveryOrders.deliveryAddressPlaceholder")})]})]}),e.jsxs("div",{className:"border rounded-md p-4 bg-muted/20",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h3",{className:"text-lg font-medium",children:a("invoices.items")})}),e.jsxs(ae,{children:[e.jsx(re,{children:e.jsxs(O,{children:[e.jsx(m,{className:"w-[30%]",children:a("products.name")}),e.jsx(m,{className:"w-[40%]",children:a("products.description")}),e.jsx(m,{className:"w-[20%]",children:"Qty"}),e.jsx(m,{className:"w-[10%]"})]})}),e.jsx(te,{children:r.items.map((s,i)=>e.jsxs(O,{children:[e.jsx(h,{children:e.jsxs(g,{value:s.product_id,onValueChange:t=>x(i,"product_id",t),children:[e.jsx(N,{children:e.jsx(b,{placeholder:a("user.selectCompany")})}),e.jsx(_,{children:u?.map(t=>e.jsx(C,{value:t.id.toString(),children:t.sku},t.id))})]})}),e.jsx(h,{children:e.jsx(j,{value:s.description,onChange:t=>x(i,"description",t.target.value)})}),e.jsx(h,{children:e.jsx(j,{type:"number",min:"1",step:"1",value:s.quantity,onChange:t=>x(i,"quantity",parseFloat(t.target.value)||0)})}),e.jsx(h,{children:e.jsx(o,{type:"button",variant:"ghost",size:"sm",onClick:()=>B(i),children:e.jsx(le,{className:"h-4 w-4 text-red-500"})})})]},i))})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:A,children:[e.jsx(P,{className:"mr-2 h-4 w-4"})," ",a("common.create")]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"notes",children:a("quotations.notes")}),e.jsx(se,{id:"notes",value:r.notes,onChange:s=>d("notes",s.target.value),placeholder:a("quotations.notesPlaceholder")})]}),e.jsxs(ee,{children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>p(!1),children:a("common.cancel")}),e.jsxs(o,{type:"submit",disabled:v,children:[v&&e.jsx(de,{className:"mr-2 h-4 w-4 animate-spin"}),a("deliveryOrders.create")]})]})]})]})]})})]}),e.jsx("div",{className:"hidden h-full flex-1 flex-col space-y-8 md:flex",children:e.jsx(G,{columns:J,data:k.data})})]})]})}export{Qe as default};
