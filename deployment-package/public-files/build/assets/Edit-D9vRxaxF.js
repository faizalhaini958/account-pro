import{r as c,j as e,H as U,a as n,L}from"./app-De9YtYVO.js";import{D as z}from"./DashboardLayout-DB0kk3mn.js";import F from"./DeleteUserForm-_GpGON3F.js";import E from"./UpdatePasswordForm-Bsk4W08Z.js";import Y from"./UpdateProfileInformationForm-BDyRmtN7.js";import{B as l,C as V}from"./index-sqIKGjOx.js";import{a as G,b as I,d as K,c as W}from"./card-B1noy23o.js";import{B as g}from"./badge-C9h6T3rK.js";import{T as q,a as J,b as o,c as t,d as Q,e as r}from"./table-3xAxy9mO.js";import{T as X,a as Z,b as j,c as f}from"./tabs-AeUBpvoT.js";import{D as $,a as ee,b as se,c as ae,d as le,e as re}from"./dialog-B_EPHwqc.js";import{A as N,a as te,b as y,c as b,d as v,e as w,f as C,g as D,h as T}from"./alert-dialog-BzBJRESa.js";import{u as ie}from"./useTranslation-CmIvGiqX.js";import{U as ne}from"./user-CJxw6ETj.js";import{C as _}from"./credit-card-wln7jJg5.js";import{T as de}from"./triangle-alert-CI0qCN5B.js";import{D as ce}from"./download-BXIOEe-u.js";import"./toaster-CljvMPLZ.js";import"./Combination-Dy-FKPUP.js";import"./dropdown-menu-BBgrL1DT.js";import"./input-YJ4y34zb.js";import"./index-DEhQiHRI.js";import"./x-D7kv7_oa.js";import"./label-BNYjQoyA.js";import"./plus-DIUrj948.js";import"./file-text-D4ZH2B6r.js";import"./building-2-B8zwlaZI.js";import"./users-Cw2EaZtR.js";import"./package-DX_4eLNa.js";import"./LanguageSwitcher-JaZwuRsp.js";import"./globe-BnAvlmAt.js";import"./ThemeToggle-IPjgC8LT.js";import"./circle-alert-nT1vmDMj.js";import"./InputError-CwsED-D-.js";import"./TextInput-STkFjRsg.js";import"./transition-CErVVnn5.js";import"./with-selector-CE-q24_V.js";import"./PrimaryButton-DXCSBiy_.js";function qe({mustVerifyEmail:S,status:A,subscription:a,transactions:d,availablePlans:m}){const{t:x}=ie(),[P,h]=c.useState(!1),[k,B]=c.useState(!1),H=()=>{n.delete(route("subscription.cancel"),{onSuccess:()=>h(!1)})},[i,u]=c.useState(null),M=s=>{a.billing_cycle==="monthly"?a.plan?.price_monthly:a.plan?.price_yearly,a.billing_cycle==="monthly"?s.price_monthly:s.price_yearly,Number(s.price_monthly)<Number(a.plan?.price_monthly)?u(s):n.visit(route("checkout.index",{plan_id:s.id}))},O=()=>{i&&n.visit(route("checkout.index",{plan_id:i.id}))};return e.jsxs(z,{header:x("profile.title"),children:[e.jsx(U,{title:x("profile.title")}),e.jsx("div",{className:"py-6",children:e.jsxs(X,{defaultValue:"profile",className:"w-full space-y-6",children:[e.jsxs(Z,{children:[e.jsxs(j,{value:"profile",className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4"}),"Profile"]}),e.jsxs(j,{value:"billing",className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4"}),"Subscription & Billing"]})]}),e.jsxs(f,{value:"profile",className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 group items-start",children:[e.jsx("div",{className:"bg-card border p-4 shadow-sm sm:rounded-lg",children:e.jsx(Y,{mustVerifyEmail:S,status:A,className:"w-full"})}),e.jsx("div",{className:"bg-card border p-4 shadow-sm sm:rounded-lg",children:e.jsx(E,{className:"w-full"})})]}),e.jsx("div",{className:"bg-card border p-4 shadow-sm sm:rounded-lg border-destructive/20",children:e.jsx(F,{className:"w-full"})})]}),e.jsx(f,{value:"billing",children:e.jsxs("div",{className:"bg-card border shadow-sm sm:rounded-lg",children:[e.jsxs(G,{children:[e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-5 w-5"}),"Subscription & Billing"]}),e.jsx(K,{children:"Manage your plan and view billing history."})]}),e.jsxs(W,{className:"space-y-8",children:[a?e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 p-4 border rounded-md bg-muted/20",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Current Plan"}),e.jsx("p",{className:"text-lg font-bold",children:a.plan?.name||"Unknown Plan"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsx(g,{variant:a.status==="active"?"default":"secondary",children:a.status})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Next Billing Date"}),e.jsx("p",{className:"font-medium",children:new Date(a.ends_at).toLocaleDateString()})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Amount"}),e.jsxs("p",{className:"font-medium",children:["RM ",a.billing_cycle==="monthly"?a.plan?.price_monthly:a.plan?.price_yearly,e.jsxs("span",{className:"text-xs text-muted-foreground",children:["/",a.billing_cycle]})]})]}),e.jsxs("div",{className:"col-span-full flex gap-2 pt-2",children:[a.status==="cancelled"&&e.jsx(l,{variant:"default",size:"sm",onClick:()=>n.visit(route("checkout.index")),children:"Reactivate Subscription"}),a.status==="active"&&e.jsxs(e.Fragment,{children:[e.jsxs(N,{open:P,onOpenChange:h,children:[e.jsx(te,{asChild:!0,children:e.jsx(l,{variant:"outline",size:"sm",className:"text-destructive hover:text-destructive",children:"Cancel Subscription"})}),e.jsxs(y,{children:[e.jsxs(b,{children:[e.jsx(v,{children:"Are you absolutely sure?"}),e.jsx(w,{children:"This action cannot be undone. This will cancel your current subscription effective immediately, and you will lose access to premium features at the end of your billing cycle."})]}),e.jsxs(C,{children:[e.jsx(D,{children:"Keep Subscription"}),e.jsx(T,{onClick:H,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Yes, Cancel Subscription"})]})]})]}),e.jsxs($,{open:k,onOpenChange:B,children:[e.jsx(ee,{asChild:!0,children:e.jsx(l,{variant:"outline",size:"sm",children:"Change Plan"})}),e.jsxs(se,{className:"sm:max-w-3xl",children:[e.jsxs(ae,{children:[e.jsx(le,{children:"Change Subscription Plan"}),e.jsx(re,{children:"Choose a new plan to upgrade or downgrade your subscription."})]}),e.jsxs("div",{className:"grid gap-4 py-4 md:grid-cols-3",children:[m?.filter(s=>s.id!==a.plan_id).map(s=>e.jsxs("div",{className:"border rounded-lg p-4 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:s.name}),e.jsxs("p",{className:"text-2xl font-bold mt-2",children:["RM ",s.price_monthly,e.jsx("span",{className:"text-sm font-normal text-muted-foreground",children:"/mo"})]}),e.jsx("div",{className:"mt-4 space-y-2",children:s.features&&s.features.slice(0,3).map((p,R)=>e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(V,{className:"h-4 w-4 mr-2 text-primary"}),p]},R))})]}),e.jsx("div",{className:"mt-6",children:e.jsx(l,{className:"w-full",onClick:()=>M(s),children:"Select Plan"})})]},s.id)),m?.filter(s=>s.id!==a.plan_id).length===0&&e.jsx("div",{className:"col-span-3 text-center py-8 text-muted-foreground",children:"No other plans available."})]})]})]}),e.jsx(N,{open:!!i,onOpenChange:s=>!s&&u(null),children:e.jsxs(y,{children:[e.jsxs(b,{children:[e.jsxs(v,{className:"flex items-center gap-2 text-amber-600",children:[e.jsx(de,{className:"h-5 w-5"}),"Downgrade Warning"]}),e.jsxs(w,{children:["You are about to downgrade to the ",e.jsx("strong",{children:i?.name})," plan.",e.jsx("br",{}),e.jsx("br",{}),"Please note that you may lose access to certain premium features associated with your current plan immediately or at the end of the billing cycle."]})]}),e.jsxs(C,{children:[e.jsx(D,{children:"Cancel"}),e.jsx(T,{onClick:O,className:"bg-amber-600 hover:bg-amber-700 text-white",children:"Confirm Downgrade"})]})]})})]})]})]}):e.jsxs("div",{className:"text-center py-6 border rounded-md border-dashed",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"You do not have an active subscription."}),e.jsx(L,{href:route("checkout.index"),children:e.jsx(l,{children:"View Plans"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Billing History"}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(q,{children:[e.jsx(J,{children:e.jsxs(o,{children:[e.jsx(t,{children:"Date"}),e.jsx(t,{children:"Amount"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Gateway"}),e.jsx(t,{className:"text-right",children:"Receipt"})]})}),e.jsx(Q,{children:d&&d.data.length>0?d.data.map(s=>e.jsxs(o,{children:[e.jsx(r,{children:s.date}),e.jsxs(r,{children:[s.currency," ",s.amount]}),e.jsx(r,{children:e.jsx(g,{variant:s.status==="success"?"outline":"secondary",className:s.status==="success"?"text-green-600 border-green-600":"",children:s.status})}),e.jsx(r,{className:"uppercase",children:s.gateway}),e.jsx(r,{className:"text-right",children:s.status==="success"&&e.jsx("a",{href:s.invoice_url,target:"_blank",rel:"noopener noreferrer",children:e.jsx(l,{variant:"ghost",size:"icon",children:e.jsx(ce,{className:"h-4 w-4"})})})})]},s.id)):e.jsx(o,{children:e.jsx(r,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No payment history found."})})})]})})]})]})]})})]})})]})}export{qe as default};
