const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/app-De9YtYVO.js","assets/app-DHuCQXno.css"])))=>i.map(i=>d[i]);
import{j as e,H as T,L as $,_ as E}from"./app-De9YtYVO.js";import{D as L}from"./DashboardLayout-DB0kk3mn.js";import{B as x}from"./index-sqIKGjOx.js";import{C as g,c as v}from"./card-B1noy23o.js";import{I as p}from"./input-YJ4y34zb.js";import{L as h}from"./label-BNYjQoyA.js";import{S as b,a as y,b as _,c as N,d as S}from"./select-B2rqhBdx.js";import{T as I}from"./textarea-BrFMof27.js";import{F as k,a as l,b as o,c as j,d,e as c}from"./form-CEzIzXmo.js";import{u as A,a as B,e as z,o as C,f as H,s as m,n as Q}from"./schemas-9rN0axaX.js";import{u as R}from"./useTranslation-CmIvGiqX.js";import{P as M}from"./plus-DIUrj948.js";import{T as G}from"./trash-2-Dreerc3R.js";import"./toaster-CljvMPLZ.js";import"./Combination-Dy-FKPUP.js";import"./dropdown-menu-BBgrL1DT.js";import"./index-DEhQiHRI.js";import"./x-D7kv7_oa.js";import"./dialog-B_EPHwqc.js";import"./file-text-D4ZH2B6r.js";import"./building-2-B8zwlaZI.js";import"./users-Cw2EaZtR.js";import"./package-DX_4eLNa.js";import"./LanguageSwitcher-JaZwuRsp.js";import"./globe-BnAvlmAt.js";import"./ThemeToggle-IPjgC8LT.js";import"./circle-alert-nT1vmDMj.js";import"./index-CENxNQLL.js";const J=C({customer_id:m().min(1,"Customer is required"),date:m().min(1,"Date is required"),delivered_at:m().optional().nullable(),delivery_address:m().optional().nullable(),notes:m().optional().nullable(),items:H(C({product_id:m().min(1,"Product is required"),description:m().min(1,"Description is required"),quantity:Q().min(1,"Quantity must be at least 1")})).min(1,"At least one item is required")});function _e({deliveryOrder:a,customers:D,products:f}){const{t:K}=R(),u=a.status==="draft",t=A({resolver:B(J),defaultValues:{customer_id:a.customer_id.toString(),date:a.date,delivered_at:a.delivered_at,delivery_address:a.delivery_address,notes:a.notes,items:a.items.map(s=>({product_id:s.product_id.toString(),description:s.description,quantity:Number(s.quantity)}))}}),{fields:F,append:q,remove:V}=z({control:t.control,name:"items"}),w=s=>{E(async()=>{const{router:r}=await import("./app-De9YtYVO.js").then(i=>i.l);return{router:r}},__vite__mapDeps([0,1])).then(({router:r})=>{r.put(route("sales.delivery-orders.update",a.id),s)})},P=(s,r)=>{const i=f.find(n=>n.id.toString()===r);i&&(t.setValue(`items.${s}.product_id`,r),t.setValue(`items.${s}.description`,i.name))};return e.jsxs(L,{header:`Edit Delivery Order: ${a.number}`,children:[e.jsx(T,{title:`Edit Delivery Order: ${a.number}`}),e.jsxs("div",{className:"max-w-5xl mx-auto py-6",children:[!u&&e.jsxs("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-md text-yellow-800",children:["This delivery order is ",a.status," and cannot be edited."]}),e.jsx(k,{...t,children:e.jsx("fieldset",{disabled:!u,className:"space-y-8",children:e.jsxs("form",{onSubmit:t.handleSubmit(w),className:"space-y-8",children:[e.jsx(g,{children:e.jsxs(v,{className:"pt-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(l,{control:t.control,name:"customer_id",render:({field:s})=>e.jsxs(o,{children:[e.jsx(j,{children:"Customer"}),e.jsxs(b,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(d,{children:e.jsx(y,{children:e.jsx(_,{placeholder:"Select Customer"})})}),e.jsx(N,{children:D.map(r=>e.jsxs(S,{value:r.id.toString(),children:[r.name," ",r.company_name?`(${r.company_name})`:""]},r.id))})]}),e.jsx(c,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(l,{control:t.control,name:"date",render:({field:s})=>e.jsxs(o,{children:[e.jsx(j,{children:"Date"}),e.jsx(d,{children:e.jsx(p,{type:"date",...s})}),e.jsx(c,{})]})}),e.jsx(l,{control:t.control,name:"delivered_at",render:({field:s})=>e.jsxs(o,{children:[e.jsx(j,{children:"Delivery Date"}),e.jsx(d,{children:e.jsx(p,{type:"date",...s,value:s.value||""})}),e.jsx(c,{})]})})]}),e.jsx(l,{control:t.control,name:"delivery_address",render:({field:s})=>e.jsxs(o,{className:"col-span-1 md:col-span-2",children:[e.jsx(j,{children:"Delivery Address"}),e.jsx(d,{children:e.jsx(I,{...s,placeholder:"Enter delivery address...",value:s.value||""})}),e.jsx(c,{})]})})]})}),e.jsx(g,{children:e.jsxs(v,{className:"pt-6 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Items"}),u&&e.jsxs(x,{type:"button",variant:"outline",size:"sm",onClick:()=>q({product_id:"",description:"",quantity:1}),children:[e.jsx(M,{className:"mr-2 h-4 w-4"})," Add Item"]})]}),F.map((s,r)=>e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-end border p-4 rounded-lg bg-gray-50/50",children:[e.jsx("div",{className:"col-span-4",children:e.jsx(l,{control:t.control,name:`items.${r}.product_id`,render:({field:i})=>e.jsxs(o,{children:[e.jsx(h,{children:"Product"}),e.jsxs(b,{onValueChange:n=>P(r,n),defaultValue:i.value,children:[e.jsx(d,{children:e.jsx(y,{children:e.jsx(_,{placeholder:"Select Product"})})}),e.jsx(N,{children:f.map(n=>e.jsxs(S,{value:n.id.toString(),children:[n.sku," - ",n.name]},n.id))})]}),e.jsx(c,{})]})})}),e.jsx("div",{className:"col-span-5",children:e.jsx(l,{control:t.control,name:`items.${r}.description`,render:({field:i})=>e.jsxs(o,{children:[e.jsx(h,{children:"Description"}),e.jsx(d,{children:e.jsx(p,{...i})}),e.jsx(c,{})]})})}),e.jsx("div",{className:"col-span-2",children:e.jsx(l,{control:t.control,name:`items.${r}.quantity`,render:({field:i})=>e.jsxs(o,{children:[e.jsx(h,{children:"Qty"}),e.jsx(d,{children:e.jsx(p,{type:"number",...i,onChange:n=>i.onChange(parseFloat(n.target.value))})}),e.jsx(c,{})]})})}),e.jsx("div",{className:"col-span-1",children:u&&e.jsx(x,{type:"button",variant:"ghost",size:"icon",className:"text-red-500",onClick:()=>V(r),children:e.jsx(G,{className:"h-4 w-4"})})})]},s.id))]})}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(x,{variant:"outline",asChild:!0,children:e.jsx($,{href:route("sales.delivery-orders.index"),children:"Back"})}),u&&e.jsx(x,{type:"submit",disabled:t.formState.isSubmitting,children:"Save Changes"})]})]})})})]})]})}export{_e as default};
