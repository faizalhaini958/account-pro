import{r as C,u as b,j as e,H as F,L as w}from"./app-De9YtYVO.js";import{A as S}from"./AdminLayout-B9Mfz47I.js";import{C as l,a as d,b as m,c as o,d as P}from"./card-B1noy23o.js";import{B as h}from"./index-sqIKGjOx.js";import{I as c}from"./input-YJ4y34zb.js";import{L as n}from"./label-BNYjQoyA.js";import{T as L}from"./textarea-BrFMof27.js";import{S as k}from"./switch-EwwwBXc8.js";import{B as M}from"./badge-C9h6T3rK.js";import{S as D}from"./toaster-CljvMPLZ.js";import{A as E}from"./arrow-left-BQixkFZB.js";import{P as I}from"./package-DX_4eLNa.js";import{P as A}from"./plus-DIUrj948.js";import{X as B}from"./x-D7kv7_oa.js";import{L as T}from"./loader-circle-DjIWaf7f.js";import"./ThemeToggle-IPjgC8LT.js";import"./shield-CJZNipff.js";import"./credit-card-wln7jJg5.js";import"./users-Cw2EaZtR.js";import"./file-text-D4ZH2B6r.js";import"./index-CENxNQLL.js";import"./Combination-Dy-FKPUP.js";import"./useTranslation-CmIvGiqX.js";import"./dropdown-menu-BBgrL1DT.js";import"./index-DEhQiHRI.js";function de({plan:r}){const[x,u]=C.useState(""),{data:a,setData:t,patch:y,processing:j,errors:i}=b({code:r.code,name:r.name,description:r.description||"",price_monthly:r.price_monthly,price_yearly:r.price_yearly,max_tenants:r.max_tenants,max_users_per_tenant:r.max_users_per_tenant,max_invoices_per_month:r.max_invoices_per_month,features:r.features||[],is_active:r.is_active,sort_order:r.sort_order}),g=s=>{s.preventDefault(),y(route("admin.subscription-plans.update",r.id))},_=()=>{x.trim()&&(t("features",[...a.features,x.trim()]),u(""))},f=s=>{t("features",a.features.filter((p,N)=>N!==s))},v=()=>{const s=a.price_monthly*12;return s<=0||a.price_yearly<=0?0:Math.round((1-a.price_yearly/s)*100)};return e.jsxs(S,{header:"Edit Subscription Plan",children:[e.jsx(F,{title:`Edit Plan: ${r.name}`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(h,{variant:"ghost",size:"icon",asChild:!0,children:e.jsx(w,{href:route("admin.subscription-plans.index"),children:e.jsx(E,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Edit Subscription Plan"}),e.jsx("p",{className:"text-muted-foreground",children:r.name})]})]}),e.jsx("form",{onSubmit:g,children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(l,{children:[e.jsx(d,{children:e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5"}),"Plan Details"]})}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"code",children:"Plan Code"}),e.jsx(c,{id:"code",value:a.code,onChange:s=>t("code",s.target.value.toLowerCase().replace(/\s/g,"_")),placeholder:"e.g., basic, pro, enterprise"}),i.code&&e.jsx("p",{className:"text-sm text-destructive",children:i.code})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"name",children:"Display Name"}),e.jsx(c,{id:"name",value:a.name,onChange:s=>t("name",s.target.value),placeholder:"e.g., Basic Plan"}),i.name&&e.jsx("p",{className:"text-sm text-destructive",children:i.name})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx(L,{id:"description",value:a.description,onChange:s=>t("description",s.target.value),placeholder:"Brief description of this plan"})]})]})]}),e.jsxs(l,{children:[e.jsx(d,{children:e.jsx(m,{children:"Pricing"})}),e.jsx(o,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"price_monthly",children:"Monthly Price (MYR)"}),e.jsx(c,{id:"price_monthly",type:"number",step:"0.01",min:"0",value:a.price_monthly,onChange:s=>t("price_monthly",parseFloat(s.target.value)||0)}),i.price_monthly&&e.jsx("p",{className:"text-sm text-destructive",children:i.price_monthly})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"price_yearly",children:"Yearly Price (MYR)"}),e.jsx(c,{id:"price_yearly",type:"number",step:"0.01",min:"0",value:a.price_yearly,onChange:s=>t("price_yearly",parseFloat(s.target.value)||0)}),i.price_yearly&&e.jsx("p",{className:"text-sm text-destructive",children:i.price_yearly}),v()>0&&e.jsxs("p",{className:"text-sm text-green-600",children:[v(),"% savings vs monthly"]})]})]})})]}),e.jsxs(l,{children:[e.jsx(d,{children:e.jsx(m,{children:"Usage Limits"})}),e.jsx(o,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"max_tenants",children:"Max Companies"}),e.jsx(c,{id:"max_tenants",type:"number",min:"1",value:a.max_tenants,onChange:s=>t("max_tenants",parseInt(s.target.value)||1)}),i.max_tenants&&e.jsx("p",{className:"text-sm text-destructive",children:i.max_tenants})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"max_users_per_tenant",children:"Max Users per Company"}),e.jsx(c,{id:"max_users_per_tenant",type:"number",min:"1",value:a.max_users_per_tenant,onChange:s=>t("max_users_per_tenant",parseInt(s.target.value)||1)}),i.max_users_per_tenant&&e.jsx("p",{className:"text-sm text-destructive",children:i.max_users_per_tenant})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"max_invoices_per_month",children:"Max Invoices/Month"}),e.jsx(c,{id:"max_invoices_per_month",type:"number",min:"1",value:a.max_invoices_per_month||"",onChange:s=>t("max_invoices_per_month",s.target.value?parseInt(s.target.value):void 0),placeholder:"Unlimited"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Leave empty for unlimited"})]})]})})]}),e.jsxs(l,{children:[e.jsxs(d,{children:[e.jsx(m,{children:"Features"}),e.jsx(P,{children:"List the features included in this plan"})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{value:x,onChange:s=>u(s.target.value),placeholder:"Add a feature...",onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),_())}}),e.jsx(h,{type:"button",variant:"secondary",onClick:_,children:e.jsx(A,{className:"h-4 w-4"})})]}),a.features.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:a.features.map((s,p)=>e.jsxs(M,{variant:"secondary",className:"gap-1",children:[s,e.jsx("button",{type:"button",onClick:()=>f(p),className:"ml-1 hover:text-destructive",children:e.jsx(B,{className:"h-3 w-3"})})]},p))})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(l,{children:[e.jsx(d,{children:e.jsx(m,{children:"Status"})}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(n,{children:"Active"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Make plan available for selection"})]}),e.jsx(k,{checked:a.is_active,onCheckedChange:s=>t("is_active",s)})]}),e.jsx(D,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"sort_order",children:"Sort Order"}),e.jsx(c,{id:"sort_order",type:"number",min:"0",value:a.sort_order,onChange:s=>t("sort_order",parseInt(s.target.value)||0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Lower numbers appear first"})]})]})]}),e.jsx(h,{type:"submit",className:"w-full",disabled:j,children:j?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):"Save Changes"})]})]})})]})]})}export{de as default};
